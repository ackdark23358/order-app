# 커피 주문 앱

### 1.1 프로젝트명
커피 주문 앱

### 1.2 프로젝트 목적
사용자가 커피 메뉴를 구문하고, 관리자가 주문을 관리할 수 있는 간단한 풀스텍 웹 앱

### 1.3 개발 범위
- 주문하기 화면(메뉴 선택 및 장바구니 기능)
- 관리자 화면(재고 관리 및 주문 상태 관리)
- 데이터를 생성/조회/수정/삭제할 수 있는 기능

## 2. 기술 스텍
- 프런트앤드: HTML, CSS, 리엑트, 자바스크립트
- 백엔드: Node.js, Express
- 데이터베이스: PostgreSQL

## 3. 기본 사항
- 프런트앤드와 백앤드를 따로 개발
- 기본적인 웹 기술만 사용
- 학습 목적이므로 사용자 인증이나 결제 기능은 제외
- 메뉴는 커피 메뉴만 있음

## 4. 화면별 상세 요구사항

### 4.1 주문하기 화면

#### 4.1.1 화면 구성
주문하기 화면은 다음과 같은 영역으로 구성됩니다:
- **헤더 영역**: 상단 고정
- **메뉴 아이템 영역**: 메인 콘텐츠 영역
- **장바구니 영역**: 하단 고정

#### 4.1.2 헤더 영역
**위치**: 화면 최상단
**구성 요소**:
- **브랜드 로고**: 좌측 상단에 "COZY" 텍스트가 포함된 다크 그린 배경의 박스
  - 배경색: 다크 그린
  - 텍스트 색상: 흰색
  - 폰트: 굵게 표시
- **주문하기 버튼**: 로고 우측에 위치
  - 버튼 텍스트: "주문하기"
  - 클릭 시: 현재 화면 유지 (현재 화면이 주문하기 화면이므로)
- **관리자 버튼**: 주문하기 버튼 우측에 위치
  - 버튼 텍스트: "관리자"
  - 클릭 시: 관리자 화면으로 이동

**스타일**:
- 배경: 흰색 또는 투명
- 텍스트: 다크 그레이
- 버튼: 회색 배경의 버튼 스타일

#### 4.1.3 메뉴 아이템 영역
**위치**: 헤더 하단, 장바구니 상단
**레이아웃**: 메뉴 아이템들이 가로로 나열된 카드 형태

**메뉴 카드 구성 요소** (각 카드별):
1. **메뉴 이미지**
   - 위치: 카드 최상단
   - 형태: 직사각형 박스
   - 플레이스홀더: 이미지가 없을 경우 대각선 크로스 표시
   - 크기: 카드 너비에 맞춤

2. **메뉴 이름**
   - 위치: 이미지 하단
   - 예시: "아메리카노(ICE)", "아메리카노(HOT)", "카페라떼"
   - 스타일: 굵은 폰트, 다크 그레이

3. **가격**
   - 위치: 메뉴 이름 하단
   - 형식: 숫자 + "원" (예: "4,000원", "5,000원")
   - 스타일: 다크 그레이

4. **설명**
   - 위치: 가격 하단
   - 텍스트: "간단한 설명..."
   - 스타일: 작은 폰트, 회색

5. **커스터마이징 옵션**
   - 위치: 설명 하단
   - 형태: 체크박스 형태의 옵션들
   - 각 옵션 구성:
     - 체크박스
     - 옵션 이름
     - 추가 가격 표시 (예: "샷 추가 (+500원)", "시럽 추가 (+0원)")
   - 기능:
     - 여러 옵션 동시 선택 가능
     - 선택 시 해당 옵션의 추가 가격이 메뉴 가격에 반영됨

6. **담기 버튼**
   - 위치: 카드 최하단
   - 버튼 텍스트: "담기"
   - 배경색: 회색
   - 기능: 클릭 시 선택된 옵션과 함께 장바구니에 추가

**카드 레이아웃**:
- 카드 간격: 적절한 여백 유지
- 반응형: 화면 크기에 따라 카드 개수 조정 가능
- 기본: 가로로 3개 이상의 카드 표시

#### 4.1.4 장바구니 영역
**위치**: 화면 하단 고정
**배경**: 큰 직사각형 박스 형태

**구성 요소**:
1. **장바구니 제목**
   - 텍스트: "장바구니"
   - 위치: 영역 상단 좌측

2. **장바구니 아이템 리스트**
   - 위치: 제목 하단 좌측
   - 각 아이템 표시 형식:
     - 메뉴 이름 (선택된 옵션 표시) + 수량
     - 예시: "아메리카노(ICE) (샷 추가) X 1"
     - 예시: "아메리카노(HOT) X 2"
   - 각 아이템 옆에 가격 표시
     - 예시: "4,500원", "8,000원"
   - 기능:
     - 동일한 메뉴 + 동일한 옵션 조합은 수량으로 합산
     - 다른 옵션 조합은 별도 아이템으로 표시

3. **총 금액**
   - 위치: 아이템 리스트 우측
   - 레이블: "총 금액"
   - 금액: 모든 아이템 가격의 합계
   - 형식: 굵은 폰트로 표시 (예: "12,500원")
   - 계산 로직:
     - 기본 메뉴 가격 + 선택된 옵션 추가 가격의 합 × 수량

4. **주문하기 버튼**
   - 위치: 총 금액 하단
   - 버튼 텍스트: "주문하기"
   - 배경색: 회색
   - 기능: 클릭 시 주문 완료 처리
   - 상태:
     - 장바구니가 비어있을 경우: 비활성화 또는 숨김 처리

**스타일**:
- 배경: 흰색 또는 연한 회색
- 텍스트: 다크 그레이
- 레이아웃: 좌측에 아이템 리스트, 우측에 총 금액 및 주문하기 버튼

#### 4.1.5 기능 요구사항

**메뉴 선택 기능**:
- 메뉴 목록을 서버에서 조회하여 표시
- 각 메뉴의 커스터마이징 옵션을 동적으로 표시
- 옵션 선택 시 실시간으로 가격 계산 (화면에만 반영, 장바구니 추가 전)

**장바구니 기능**:
- "담기" 버튼 클릭 시:
  - 선택된 메뉴와 옵션을 장바구니에 추가
  - 동일한 메뉴+옵션 조합이 이미 있으면 수량 증가
  - 장바구니에 추가된 아이템의 총 가격 계산
- 장바구니 아이템 수량 조절 기능 (추가/삭제)
- 장바구니 아이템 삭제 기능
- 장바구니 총 금액 실시간 계산 및 표시

**주문 처리 기능**:
- "주문하기" 버튼 클릭 시:
  - 장바구니의 모든 아이템을 주문으로 전송
  - 주문 성공 시 장바구니 비우기
  - 주문 완료 메시지 표시 (선택사항)

#### 4.1.6 UI/UX 요구사항
- **디자인**: 깔끔하고 미니멀한 디자인
- **색상**: 
  - 배경: 흰색
  - 텍스트: 다크 그레이
  - 강조: 다크 그린 (브랜드 로고)
  - 버튼: 회색 배경
- **반응형**: 다양한 화면 크기에 대응 가능
- **사용성**: 직관적이고 사용하기 쉬운 인터페이스
- **피드백**: 버튼 클릭, 아이템 추가 등 사용자 액션에 대한 시각적 피드백 제공

### 4.2 관리자 화면

#### 4.2.1 화면 구성
관리자 화면은 다음과 같은 영역으로 구성됩니다:
- **헤더 영역**: 상단 고정
- **관리자 대시보드 영역**: 주문 통계 요약
- **재고 현황 영역**: 메뉴별 재고 관리
- **주문 현황 영역**: 주문 목록 및 상태 관리

#### 4.2.2 헤더 영역
**위치**: 화면 최상단
**구성 요소**:
- **브랜드 로고**: 좌측 상단에 "COZY" 텍스트가 포함된 박스
  - 배경: 흰색 또는 투명
  - 테두리: 얇은 다크 그레이 테두리
  - 텍스트 색상: 다크 그레이
  - 폰트: 산세리프 폰트
- **주문하기 버튼**: 로고 우측에 위치
  - 버튼 텍스트: "주문하기"
  - 클릭 시: 주문하기 화면으로 이동
- **관리자 버튼**: 주문하기 버튼 우측에 위치
  - 버튼 텍스트: "관리자"
  - 상태: 현재 화면이 관리자 화면이므로 다크 그레이 테두리로 강조 표시
  - 클릭 시: 현재 화면 유지

**스타일**:
- 배경: 흰색
- 텍스트: 다크 그레이
- 활성화된 버튼: 다크 그레이 테두리로 강조

#### 4.2.3 관리자 대시보드 영역
**위치**: 헤더 하단, 첫 번째 메인 콘텐츠 섹션
**배경**: 연한 회색 배경의 둥근 모서리 박스

**구성 요소**:
- **섹션 제목**: "관리자 대시보드"
- **주문 통계 표시**:
  - 형식: "총 주문 X / 주문 접수 Y / 제조 중 Z / 제조 완료 W"
  - 예시: "총 주문 1 / 주문 접수 1 / 제조 중 0 / 제조 완료 0"
  - 각 통계 항목:
    - **총 주문**: 전체 주문 건수
    - **주문 접수**: 접수된 주문 건수
    - **제조 중**: 현재 제조 중인 주문 건수
    - **제조 완료**: 제조가 완료된 주문 건수

**기능**:
- 실시간으로 주문 통계 업데이트
- 각 통계는 서버에서 조회하여 표시

**스타일**:
- 배경: 연한 회색 박스
- 텍스트: 다크 그레이
- 레이아웃: 한 줄로 표시, 각 통계는 "/"로 구분

#### 4.2.4 재고 현황 영역
**위치**: 관리자 대시보드 하단, 두 번째 메인 콘텐츠 섹션
**배경**: 연한 회색 배경의 둥근 모서리 박스

**구성 요소**:
- **섹션 제목**: "재고 현황"
- **재고 아이템 카드들**: 가로로 나열된 카드 형태
  - 각 카드 구성:
    1. **메뉴 이름**
       - 예시: "아메리카노 (ICE)", "아메리카노 (HOT)", "카페라떼"
       - 스타일: 다크 그레이, 굵은 폰트
    2. **재고 수량**
       - 형식: 숫자 + "개" (예: "10개")
       - 위치: 메뉴 이름 하단 또는 옆
       - 스타일: 다크 그레이
    3. **재고 조절 버튼**
       - **+ 버튼**: 재고 증가 버튼
         - 위치: 재고 수량 하단 또는 옆
         - 기능: 클릭 시 해당 메뉴의 재고 1개 증가
       - **- 버튼**: 재고 감소 버튼
         - 위치: + 버튼 옆 또는 하단
         - 기능: 클릭 시 해당 메뉴의 재고 1개 감소
         - 제약: 재고가 0일 경우 비활성화 또는 최소값 유지

**카드 레이아웃**:
- 카드 간격: 적절한 여백 유지
- 가로 배치: 3개 이상의 카드를 가로로 나열
- 반응형: 화면 크기에 따라 카드 개수 조정 가능

**기능**:
- 각 메뉴별 재고 수량을 서버에서 조회하여 표시
- +/- 버튼 클릭 시:
  - 재고 수량 즉시 업데이트 (낙관적 업데이트)
  - 서버에 재고 변경 요청 전송
  - 성공/실패에 따른 피드백 제공
- 재고 변경 시 실시간으로 화면 업데이트

**스타일**:
- 배경: 연한 회색 박스
- 카드 배경: 흰색 또는 연한 회색
- 버튼: 회색 배경 또는 테두리 버튼

#### 4.2.5 주문 현황 영역
**위치**: 재고 현황 하단, 세 번째 메인 콘텐츠 섹션
**배경**: 연한 회색 배경의 둥근 모서리 박스

**구성 요소**:
- **섹션 제목**: "주문 현황"
- **주문 리스트**: 주문 목록을 세로로 나열
  - 각 주문 항목 구성:
    1. **주문 날짜 및 시간**
       - 형식: "월 일 시:분" (예: "7월 31일 13:00")
       - 위치: 주문 항목 상단 또는 좌측
       - 스타일: 다크 그레이
    2. **주문 메뉴 정보**
       - 형식: "메뉴명 (옵션) x 수량" (예: "아메리카노(ICE) x 1")
       - 위치: 날짜/시간 하단 또는 옆
       - 여러 메뉴가 있을 경우: 각 메뉴를 줄바꿈하여 표시
    3. **주문 금액**
       - 형식: 숫자 + "원" (예: "4,000원")
       - 위치: 메뉴 정보 하단 또는 옆
       - 스타일: 다크 그레이
    4. **주문 접수 버튼**
       - 버튼 텍스트: "주문 접수"
       - 위치: 주문 항목 우측
       - 기능: 클릭 시 해당 주문을 "주문 접수" 상태로 변경
       - 상태:
         - 주문 접수 전: 활성화 상태
         - 주문 접수 후: 비활성화 또는 "접수 완료" 텍스트로 변경

**주문 상태별 표시**:
- 주문은 상태에 따라 분류되어 표시될 수 있음
- 기본적으로 최신 주문이 상단에 표시
- 주문 상태:
  - **대기 중**: 주문 접수 전 상태
  - **주문 접수**: 접수 완료 상태
  - **제조 중**: 제조 시작 상태
  - **제조 완료**: 제조 완료 상태

**기능**:
- 주문 목록을 서버에서 조회하여 표시
- "주문 접수" 버튼 클릭 시:
  - 해당 주문의 상태를 "주문 접수"로 변경
  - 서버에 상태 변경 요청 전송
  - 성공 시 주문 현황 및 대시보드 통계 업데이트
- 주문 목록 실시간 업데이트 (폴링 또는 웹소켓)
- 주문이 없을 경우: "주문이 없습니다" 메시지 표시

**스타일**:
- 배경: 연한 회색 박스
- 주문 항목: 흰색 또는 연한 회색 배경
- 텍스트: 다크 그레이
- 버튼: 회색 배경 또는 테두리 버튼
- 레이아웃: 각 주문 항목은 세로로 나열, 좌측에 주문 정보, 우측에 버튼

#### 4.2.6 기능 요구사항

**대시보드 통계 기능**:
- 주문 통계를 서버에서 조회하여 표시
- 실시간 또는 주기적으로 통계 업데이트
- 각 통계 항목은 현재 주문 상태를 기반으로 계산

**재고 관리 기능**:
- 메뉴별 재고 수량 조회 및 표시
- 재고 증가/감소 기능
- 재고 변경 시 서버에 즉시 반영
- 재고가 0 이하로 내려가지 않도록 제약
- 재고 변경 이력 관리 (선택사항)

**주문 관리 기능**:
- 주문 목록 조회 및 표시
- 주문 상태 변경 기능 (주문 접수, 제조 중, 제조 완료)
- 주문 상세 정보 표시 (메뉴, 옵션, 수량, 가격)
- 주문 상태별 필터링 기능 (선택사항)
- 주문 삭제 기능 (선택사항)

**데이터 동기화**:
- 주문하기 화면에서 주문이 발생하면 관리자 화면에 즉시 반영
- 주문 상태 변경 시 대시보드 통계 자동 업데이트
- 실시간 업데이트를 위한 폴링 또는 웹소켓 사용 (선택사항)

#### 4.2.7 UI/UX 요구사항
- **디자인**: 깔끔하고 미니멀한 디자인, 주문하기 화면과 일관성 유지
- **색상**: 
  - 배경: 흰색
  - 텍스트: 다크 그레이
  - 섹션 박스: 연한 회색 배경
  - 버튼: 회색 배경 또는 테두리
- **레이아웃**: 세로로 나열된 섹션 구조
- **반응형**: 다양한 화면 크기에 대응 가능
- **사용성**: 
  - 직관적인 버튼 배치
  - 명확한 상태 표시
  - 빠른 작업 수행 가능
- **피드백**: 
  - 버튼 클릭 시 즉각적인 시각적 피드백
  - 재고 변경, 주문 접수 등 작업 성공/실패 메시지 표시
  - 로딩 상태 표시 (선택사항)

## 5. 백엔드 개발 요구사항

### 5.1 데이터 모델

#### 5.1.1 Menus (메뉴)
메뉴 정보를 저장하는 테이블입니다.

**필드 구성**:
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 메뉴 고유 ID
- `name` (VARCHAR): 커피 메뉴 이름 (예: "아메리카노(ICE)", "카페라떼")
- `description` (TEXT): 메뉴 설명
- `price` (INTEGER): 기본 가격 (원 단위)
- `image_url` (VARCHAR, NULLABLE): 메뉴 이미지 URL (선택사항)
- `stock` (INTEGER): 재고 수량 (기본값: 0)
- `created_at` (TIMESTAMP): 생성 일시
- `updated_at` (TIMESTAMP): 수정 일시

**제약사항**:
- `name`은 필수이며 중복될 수 있음 (같은 이름의 다른 옵션 메뉴 가능)
- `price`는 0 이상의 정수
- `stock`은 0 이상의 정수

#### 5.1.2 Options (옵션)
메뉴 커스터마이징 옵션을 저장하는 테이블입니다.

**필드 구성**:
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 옵션 고유 ID
- `menu_id` (INTEGER, FOREIGN KEY): 연결된 메뉴 ID (Menus 테이블 참조)
- `name` (VARCHAR): 옵션 이름 (예: "샷 추가", "시럽 추가")
- `price` (INTEGER): 옵션 추가 가격 (원 단위, 기본값: 0)
- `created_at` (TIMESTAMP): 생성 일시
- `updated_at` (TIMESTAMP): 수정 일시

**제약사항**:
- `menu_id`는 Menus 테이블의 유효한 ID여야 함
- `name`은 필수
- `price`는 0 이상의 정수 (음수 가능, 할인 옵션의 경우)

**관계**:
- 하나의 메뉴는 여러 옵션을 가질 수 있음 (1:N 관계)
- 옵션 삭제 시: CASCADE 또는 SET NULL 정책 적용

#### 5.1.3 Orders (주문)
주문 정보를 저장하는 테이블입니다.

**필드 구성**:
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 주문 고유 ID
- `order_date` (TIMESTAMP): 주문 일시
- `status` (VARCHAR): 주문 상태
  - 가능한 값: 'received' (주문 접수), 'preparing' (제조 중), 'completed' (제조 완료)
  - 기본값: 'received'
- `total_amount` (INTEGER): 주문 총 금액 (원 단위)
- `created_at` (TIMESTAMP): 생성 일시
- `updated_at` (TIMESTAMP): 수정 일시

**제약사항**:
- `order_date`는 필수
- `status`는 위의 세 가지 값 중 하나여야 함
- `total_amount`는 0 이상의 정수

#### 5.1.4 OrderItems (주문 상세)
주문에 포함된 각 메뉴 항목의 상세 정보를 저장하는 테이블입니다.

**필드 구성**:
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 주문 상세 항목 고유 ID
- `order_id` (INTEGER, FOREIGN KEY): 주문 ID (Orders 테이블 참조)
- `menu_id` (INTEGER, FOREIGN KEY): 메뉴 ID (Menus 테이블 참조)
- `quantity` (INTEGER): 주문 수량
- `unit_price` (INTEGER): 단가 (메뉴 기본 가격 + 옵션 가격의 합)
- `total_price` (INTEGER): 항목별 총 가격 (단가 × 수량)
- `created_at` (TIMESTAMP): 생성 일시

**제약사항**:
- `order_id`는 Orders 테이블의 유효한 ID여야 함
- `menu_id`는 Menus 테이블의 유효한 ID여야 함
- `quantity`는 1 이상의 정수
- `unit_price`와 `total_price`는 0 이상의 정수

**관계**:
- 하나의 주문은 여러 주문 항목을 가질 수 있음 (1:N 관계)
- 주문 삭제 시: 주문 항목도 함께 삭제 (CASCADE)

#### 5.1.5 OrderItemOptions (주문 항목 옵션)
주문 항목에 선택된 옵션 정보를 저장하는 테이블입니다.

**필드 구성**:
- `id` (INTEGER, PRIMARY KEY, AUTO INCREMENT): 고유 ID
- `order_item_id` (INTEGER, FOREIGN KEY): 주문 항목 ID (OrderItems 테이블 참조)
- `option_id` (INTEGER, FOREIGN KEY): 옵션 ID (Options 테이블 참조)
- `created_at` (TIMESTAMP): 생성 일시

**제약사항**:
- `order_item_id`는 OrderItems 테이블의 유효한 ID여야 함
- `option_id`는 Options 테이블의 유효한 ID여야 함
- 하나의 주문 항목에 같은 옵션이 중복될 수 없음 (UNIQUE 제약)

**관계**:
- 하나의 주문 항목은 여러 옵션을 가질 수 있음 (1:N 관계)
- 주문 항목 삭제 시: 관련 옵션도 함께 삭제 (CASCADE)

### 5.2 데이터 스키마를 위한 사용자 흐름

#### 5.2.1 메뉴 조회 및 표시 흐름
1. **프런트엔드 요청**: 주문하기 화면 진입 시 메뉴 목록 조회 요청
2. **백엔드 처리**: 
   - Menus 테이블에서 모든 메뉴 조회
   - 각 메뉴에 연결된 Options 테이블의 옵션 정보 조회
   - 재고 수량(stock) 정보 포함
3. **응답 데이터**: 
   - 메뉴 정보 (id, name, description, price, image_url, stock)
   - 각 메뉴별 옵션 목록 (id, name, price)
4. **프런트엔드 표시**:
   - 메뉴 카드에 메뉴 정보 표시
   - 옵션 체크박스에 옵션 정보 표시
   - 재고 수량은 관리자 화면에만 표시 (일반 사용자 화면에는 표시하지 않음)

#### 5.2.2 장바구니 관리 흐름
1. **사용자 액션**: 사용자가 메뉴 선택 및 옵션 선택
2. **프런트엔드 처리**: 
   - 선택된 메뉴와 옵션 정보를 클라이언트 측 장바구니에 저장 (세션/로컬 스토리지)
   - 재고 확인 (서버에서 받은 재고 정보 기반)
3. **재고 확인**: 
   - 장바구니에 추가 전 재고 확인
   - 재고 부족 시 사용자에게 알림

#### 5.2.3 주문 생성 흐름
1. **사용자 액션**: 장바구니에서 '주문하기' 버튼 클릭
2. **프런트엔드 요청**: 
   - 주문 정보를 서버로 전송
   - 요청 데이터:
     - 주문 일시 (또는 서버에서 생성)
     - 주문 항목 배열:
       - menu_id
       - quantity
       - 선택된 option_ids 배열
       - 단가 (메뉴 가격 + 옵션 가격 합계)
       - 항목별 총 가격
     - 총 금액
3. **백엔드 처리**:
   - **트랜잭션 시작**
   - 재고 재확인 (동시성 제어)
   - Orders 테이블에 주문 정보 저장
   - OrderItems 테이블에 주문 항목 저장
   - OrderItemOptions 테이블에 선택된 옵션 저장
   - Menus 테이블의 재고 수량 차감 (각 메뉴별로 수량만큼 차감)
   - **트랜잭션 커밋**
4. **응답**: 
   - 주문 성공 여부
   - 주문 ID
   - 생성된 주문 정보
5. **프런트엔드 처리**: 
   - 주문 성공 시 장바구니 비우기
   - 주문 완료 메시지 표시

#### 5.2.4 주문 현황 조회 흐름
1. **프런트엔드 요청**: 관리자 화면 진입 시 주문 목록 조회 요청
2. **백엔드 처리**: 
   - Orders 테이블에서 모든 주문 조회 (최신순 정렬)
   - 각 주문의 OrderItems 조회
   - 각 주문 항목의 OrderItemOptions 조회
   - 메뉴 정보 조인하여 메뉴 이름 조회
   - 옵션 정보 조인하여 옵션 이름 조회
3. **응답 데이터**: 
   - 주문 목록 배열:
     - order_id
     - order_date
     - status
     - total_amount
     - items 배열:
       - menu_name
       - quantity
       - option_names 배열
       - total_price
4. **프런트엔드 표시**: 
   - 주문 현황 영역에 주문 목록 표시
   - 주문 상태에 따라 버튼 표시 ('제조 시작', '제조 완료', '완료됨')

#### 5.2.5 주문 상태 변경 흐름
1. **사용자 액션**: 관리자가 '제조 시작' 또는 '제조 완료' 버튼 클릭
2. **프런트엔드 요청**: 
   - 주문 ID와 새로운 상태를 서버로 전송
   - 요청 데이터:
     - order_id
     - new_status ('preparing' 또는 'completed')
3. **백엔드 처리**: 
   - Orders 테이블에서 해당 주문 조회
   - 주문 상태 업데이트
   - 상태 변경 이력 기록 (선택사항)
4. **응답**: 
   - 업데이트 성공 여부
   - 업데이트된 주문 정보
5. **프런트엔드 처리**: 
   - 주문 현황 화면 업데이트
   - 대시보드 통계 업데이트

#### 5.2.6 재고 관리 흐름
1. **프런트엔드 요청**: 관리자 화면에서 재고 조회 요청
2. **백엔드 처리**: 
   - Menus 테이블에서 모든 메뉴의 재고 정보 조회
3. **응답 데이터**: 
   - 메뉴별 재고 정보 배열:
     - menu_id
     - menu_name
     - stock
4. **재고 수정**:
   - 관리자가 +/- 버튼 클릭
   - 프런트엔드에서 재고 변경 요청 (menu_id, change_amount)
   - 백엔드에서 Menus 테이블의 stock 업데이트
   - 재고가 0 미만으로 내려가지 않도록 제약

### 5.3 API 설계

#### 5.3.1 메뉴 관련 API

**GET /api/menus**
- **설명**: 커피 메뉴 목록을 조회합니다.
- **요청**: 없음
- **응답**:
  ```json
  {
    "success": true,
    "data": [
      {
        "id": 1,
        "name": "아메리카노(ICE)",
        "description": "에스프레소에 물을 넣어 만든 시원한 아메리카노",
        "price": 4000,
        "image_url": null,
        "stock": 10,
        "options": [
          {
            "id": 1,
            "name": "샷 추가",
            "price": 500
          },
          {
            "id": 2,
            "name": "시럽 추가",
            "price": 0
          }
        ]
      }
    ]
  }
  ```
- **에러 응답**:
  ```json
  {
    "success": false,
    "error": "메뉴 조회 중 오류가 발생했습니다."
  }
  ```

**GET /api/menus/:id**
- **설명**: 특정 메뉴의 상세 정보를 조회합니다.
- **요청 파라미터**: 
  - `id` (URL 파라미터): 메뉴 ID
- **응답**: 단일 메뉴 객체 (위와 동일한 구조)

**PUT /api/menus/:id/stock**
- **설명**: 특정 메뉴의 재고를 수정합니다.
- **요청 파라미터**: 
  - `id` (URL 파라미터): 메뉴 ID
- **요청 본문**:
  ```json
  {
    "change": 1  // 양수: 증가, 음수: 감소
  }
  ```
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "id": 1,
      "name": "아메리카노(ICE)",
      "stock": 11
    }
  }
  ```
- **에러 응답**:
  ```json
  {
    "success": false,
    "error": "재고가 0 미만으로 내려갈 수 없습니다."
  }
  ```

#### 5.3.2 주문 관련 API

**POST /api/orders**
- **설명**: 새로운 주문을 생성합니다.
- **요청 본문**:
  ```json
  {
    "items": [
      {
        "menu_id": 1,
        "quantity": 2,
        "option_ids": [1, 2],
        "unit_price": 4500,
        "total_price": 9000
      },
      {
        "menu_id": 3,
        "quantity": 1,
        "option_ids": [],
        "unit_price": 5000,
        "total_price": 5000
      }
    ],
    "total_amount": 14000
  }
  ```
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "id": 1,
      "order_date": "2024-01-25T13:00:00Z",
      "status": "received",
      "total_amount": 14000,
      "items": [
        {
          "id": 1,
          "menu_id": 1,
          "menu_name": "아메리카노(ICE)",
          "quantity": 2,
          "unit_price": 4500,
          "total_price": 9000,
          "options": [
            {
              "id": 1,
              "name": "샷 추가",
              "price": 500
            },
            {
              "id": 2,
              "name": "시럽 추가",
              "price": 0
            }
          ]
        }
      ]
    }
  }
  ```
- **에러 응답**:
  ```json
  {
    "success": false,
    "error": "재고가 부족합니다.",
    "details": [
      {
        "menu_id": 1,
        "menu_name": "아메리카노(ICE)",
        "requested_quantity": 2,
        "available_stock": 1
      }
    ]
  }
  ```

**GET /api/orders**
- **설명**: 주문 목록을 조회합니다.
- **요청 쿼리 파라미터** (선택사항):
  - `status`: 주문 상태 필터 ('received', 'preparing', 'completed')
  - `limit`: 조회할 최대 개수 (기본값: 100)
  - `offset`: 건너뛸 개수 (페이지네이션용)
- **응답**:
  ```json
  {
    "success": true,
    "data": [
      {
        "id": 1,
        "order_date": "2024-01-25T13:00:00Z",
        "status": "received",
        "total_amount": 14000,
        "items": [
          {
            "menu_name": "아메리카노(ICE)",
            "quantity": 2,
            "option_names": ["샷 추가", "시럽 추가"],
            "total_price": 9000
          }
        ]
      }
    ],
    "total": 10
  }
  ```

**GET /api/orders/:id**
- **설명**: 특정 주문의 상세 정보를 조회합니다.
- **요청 파라미터**: 
  - `id` (URL 파라미터): 주문 ID
- **응답**: 단일 주문 객체 (위와 동일한 구조)

**PUT /api/orders/:id/status**
- **설명**: 주문 상태를 변경합니다.
- **요청 파라미터**: 
  - `id` (URL 파라미터): 주문 ID
- **요청 본문**:
  ```json
  {
    "status": "preparing"  // 'preparing' 또는 'completed'
  }
  ```
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "id": 1,
      "status": "preparing",
      "updated_at": "2024-01-25T13:05:00Z"
    }
  }
  ```
- **에러 응답**:
  ```json
  {
    "success": false,
    "error": "유효하지 않은 주문 상태입니다."
  }
  ```

#### 5.3.3 통계 관련 API

**GET /api/stats/orders**
- **설명**: 주문 통계를 조회합니다.
- **요청**: 없음
- **응답**:
  ```json
  {
    "success": true,
    "data": {
      "total": 10,
      "received": 3,
      "preparing": 2,
      "completed": 5
    }
  }
  ```

#### 5.3.4 공통 응답 형식

**성공 응답**:
- HTTP 상태 코드: 200 (OK)
- 본문: `{ "success": true, "data": ... }`

**에러 응답**:
- HTTP 상태 코드: 
  - 400: 잘못된 요청
  - 404: 리소스를 찾을 수 없음
  - 500: 서버 내부 오류
- 본문: `{ "success": false, "error": "에러 메시지", "details": ... }`

#### 5.3.5 API 구현 시 고려사항

1. **트랜잭션 처리**:
   - 주문 생성 시 Orders, OrderItems, OrderItemOptions, Menus 테이블 업데이트를 하나의 트랜잭션으로 처리
   - 트랜잭션 실패 시 롤백 처리

2. **동시성 제어**:
   - 주문 생성 시 재고 확인 및 차감을 원자적으로 처리 (SELECT FOR UPDATE 또는 비관적 락 사용)
   - 동시 주문 시 재고 부족 방지

3. **데이터 검증**:
   - 요청 데이터 유효성 검사 (필수 필드, 데이터 타입, 범위 등)
   - 외래키 무결성 검사

4. **에러 처리**:
   - 명확한 에러 메시지 제공
   - 로깅을 통한 에러 추적

5. **성능 최적화**:
   - 인덱스 활용 (order_date, status, menu_id 등)
   - N+1 쿼리 문제 방지 (JOIN 또는 Eager Loading 사용)

6. **보안**:
   - SQL Injection 방지 (파라미터화된 쿼리 사용)
   - XSS 방지 (입력 데이터 검증 및 이스케이프)
